<?php

declare(strict_types=1);

namespace HeptaConnect\Production\DevOps\DependencyInjection\CompilerPass;

use Symfony\Component\DependencyInjection\Compiler\CompilerPassInterface;
use Symfony\Component\DependencyInjection\ContainerBuilder;

final class RemoveObstructiveServices implements CompilerPassInterface
{
    private const REMOVE_DEFINITIONS = [
        'assets.packages',
        'console.command.translation_debug',
        'console.command.translation_extract',
        'console.command.translation_pull',
        'console.command.translation_push',
        'framework.filesystem.private',
        'framework.filesystem.public',
        'hepta_connect_bridge_shopware_platform.filesystem.public',
        'integration.filesystem.private',
        'integration.filesystem.public',
        'maintenance.filesystem.private',
        'maintenance.filesystem.public',
        'shopware.app_system.guzzle',
        'shopware.app_system.guzzle.middleware',
        'shopware.asset.asset',
        'shopware.asset.asset.version_strategy',
        'shopware.asset.theme',
        'shopware.asset.theme.version_strategy',
        'shopware.filesystem.asset',
        'shopware.filesystem.public',
        'shopware.filesystem.sitemap',
        'shopware.filesystem.temp',
        'shopware.filesystem.theme',
        'translation.warmer',
        \Shopware\Core\Checkout\Cart\ApiOrderCartService::class,
        \Shopware\Core\Content\Category\CategoryHydrator::class,
        \Shopware\Core\Content\Media\Message\GenerateThumbnailsHandler::class,
        \Shopware\Core\Content\Product\Aggregate\ProductConfiguratorSetting\ProductConfiguratorSettingHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductCrossSelling\ProductCrossSellingHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductCrossSellingAssignedProducts\ProductCrossSellingAssignedProductsHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductFeatureSet\ProductFeatureSetHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductKeywordDictionary\ProductKeywordDictionaryHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductManufacturer\ProductManufacturerHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductMedia\ProductMediaHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductPrice\ProductPriceHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductReview\ProductReviewHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductSearchConfig\ProductSearchConfigHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductSearchConfigField\ProductSearchConfigFieldHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductSearchKeyword\ProductSearchKeywordHydrator::class,
        \Shopware\Core\Content\Product\Aggregate\ProductVisibility\ProductVisibilityHydrator::class,
        \Shopware\Core\Content\Product\ProductHydrator::class,
        \Shopware\Core\Content\Product\SalesChannel\Sorting\ProductSortingHydrator::class,
        \Shopware\Core\Content\Product\SearchKeyword\ProductSearchTermInterpreter::class,
        \Shopware\Core\Content\ProductExport\ProductExportHydrator::class,
        \Shopware\Core\Content\ProductStream\Aggregate\ProductStreamFilter\ProductStreamFilterHydrator::class,
        \Shopware\Core\Content\ProductStream\ProductStreamHydrator::class,
        \Shopware\Core\Content\Property\Aggregate\PropertyGroupOption\PropertyGroupOptionHydrator::class,
        \Shopware\Core\Content\Property\PropertyGroupHydrator::class,
        \Shopware\Core\Content\Seo\Api\SeoActionController::class,
        \Shopware\Core\Content\Seo\CachedSeoResolver::class,
        \Shopware\Core\Content\Seo\EmptyPathInfoResolver::class,
        \Shopware\Core\Content\Seo\Entity\Dbal\SeoUrlAssociationFieldResolver::class,
        \Shopware\Core\Content\Seo\Entity\Serializer\SeoUrlFieldSerializer::class,
        \Shopware\Core\Content\Seo\HreflangLoaderInterface::class,
        \Shopware\Core\Content\Seo\MainCategory\SalesChannel\SalesChannelMainCategoryDefinition::class,
        \Shopware\Core\Content\Seo\SalesChannel\SeoUrlRoute::class,
        \Shopware\Core\Content\Seo\SalesChannel\StoreApiSeoResolver::class,
        \Shopware\Core\Content\Seo\SeoResolver::class,
        \Shopware\Core\Content\Seo\SeoUrl\SalesChannel\SalesChannelSeoUrlDefinition::class,
        \Shopware\Core\Content\Seo\SeoUrlGenerator::class,
        \Shopware\Core\Content\Seo\SeoUrlPersister::class,
        \Shopware\Core\Content\Seo\SeoUrlPlaceholderHandlerInterface::class,
        \Shopware\Core\Content\Seo\SeoUrlRoute\SeoUrlRouteRegistry::class,
        \Shopware\Core\Content\Seo\SeoUrlTwigFactory::class,
        \Shopware\Core\Content\Seo\SeoUrlUpdater::class,
        \Shopware\Core\Content\Seo\Validation\SeoUrlValidationFactory::class,
        \Shopware\Core\Framework\Adapter\Cache\CacheStateSubscriber::class,
        \Shopware\Core\Framework\Adapter\Cache\CacheTracer::class,
        \Shopware\Core\Framework\Adapter\Cache\Script\ScriptCacheInvalidationSubscriber::class,
        \Shopware\Core\Framework\Adapter\Command\S3FilesystemVisibilityCommand::class,
        \Shopware\Core\Framework\Adapter\Filesystem\FilesystemFactory::class . '.amazon_s3',
        \Shopware\Core\Framework\Adapter\Filesystem\FilesystemFactory::class . '.google_storage',
        \Shopware\Core\Framework\Adapter\Translation\Translator::class,
        \Shopware\Core\Framework\Adapter\Translation\TranslatorCacheInvalidate::class,
        \Shopware\Core\Framework\Adapter\Twig\AppTemplateIterator::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\BuildBreadcrumbExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\CategoryUrlExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\FeatureFlagExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\InstanceOfExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\MediaExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\NodeExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\PhpSyntaxExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\RawUrlFunctionExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\SeoUrlFunctionExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\Extension\SwSanitizeTwigFilter::class,
        \Shopware\Core\Framework\Adapter\Twig\Filter\CurrencyFilter::class,
        \Shopware\Core\Framework\Adapter\Twig\Filter\ReplaceRecursiveFilter::class,
        \Shopware\Core\Framework\Adapter\Twig\NamespaceHierarchy\BundleHierarchyBuilder::class,
        \Shopware\Core\Framework\Adapter\Twig\NamespaceHierarchy\NamespaceHierarchyBuilder::class,
        \Shopware\Core\Framework\Adapter\Twig\SecurityExtension::class,
        \Shopware\Core\Framework\Adapter\Twig\StringTemplateRenderer::class,
        \Shopware\Core\Framework\Adapter\Twig\TemplateFinder::class,
        \Shopware\Core\Framework\Adapter\Twig\TemplateIterator::class,
        \Shopware\Core\Framework\Adapter\Twig\TwigVariableParser::class,
        \Shopware\Core\Framework\Api\Acl\AclAnnotationValidator::class,
        \Shopware\Core\Framework\Api\Acl\AclCriteriaValidator::class,
        \Shopware\Core\Framework\Api\Acl\AclWriteValidator::class,
        \Shopware\Core\Framework\Api\Command\DumpClassSchemaCommand::class,
        \Shopware\Core\Framework\Api\Command\DumpSchemaCommand::class,
        \Shopware\Core\Framework\Api\Controller\AccessKeyController::class,
        \Shopware\Core\Framework\Api\Controller\AclController::class,
        \Shopware\Core\Framework\Api\Controller\ApiController::class,
        \Shopware\Core\Framework\Api\Controller\AuthController::class,
        \Shopware\Core\Framework\Api\Controller\CustomSnippetFormatController::class,
        \Shopware\Core\Framework\Api\Controller\FallbackController::class,
        \Shopware\Core\Framework\Api\Controller\IndexingController::class,
        \Shopware\Core\Framework\Api\Controller\InfoController::class,
        \Shopware\Core\Framework\Api\Controller\IntegrationController::class,
        \Shopware\Core\Framework\Api\Controller\SalesChannelProxyController::class,
        \Shopware\Core\Framework\Api\Controller\SyncController::class,
        \Shopware\Core\Framework\Api\Controller\UserController::class,
        \Shopware\Core\Framework\Api\EventListener\Acl\CreditOrderLineItemListener::class,
        \Shopware\Core\Framework\Api\EventListener\Authentication\SalesChannelAuthenticationListener::class,
        \Shopware\Core\Framework\Api\EventListener\Authentication\UserCredentialsChangedSubscriber::class,
        \Shopware\Core\Framework\Api\Sync\SyncService::class,
        \Shopware\Core\Framework\App\ActionButton\ActionButtonLoader::class,
        \Shopware\Core\Framework\App\ActionButton\AppActionLoader::class,
        \Shopware\Core\Framework\App\ActionButton\Executor::class,
        \Shopware\Core\Framework\App\ActionButton\Response\ActionButtonResponseFactory::class,
        \Shopware\Core\Framework\App\ActionButton\Response\NotificationResponseFactory::class,
        \Shopware\Core\Framework\App\ActionButton\Response\OpenModalResponseFactory::class,
        \Shopware\Core\Framework\App\ActionButton\Response\OpenNewTabResponseFactory::class,
        \Shopware\Core\Framework\App\ActionButton\Response\ReloadDataResponseFactory::class,
        \Shopware\Core\Framework\App\ActiveAppsLoader::class,
        \Shopware\Core\Framework\App\Api\AppActionController::class,
        \Shopware\Core\Framework\App\Api\AppCmsController::class,
        \Shopware\Core\Framework\App\Api\AppUrlChangeController::class,
        \Shopware\Core\Framework\App\AppLocaleProvider::class,
        \Shopware\Core\Framework\App\AppService::class,
        \Shopware\Core\Framework\App\AppStateService::class,
        \Shopware\Core\Framework\App\AppUrlChangeResolver\MoveShopPermanentlyStrategy::class,
        \Shopware\Core\Framework\App\AppUrlChangeResolver\ReinstallAppsStrategy::class,
        \Shopware\Core\Framework\App\AppUrlChangeResolver\Resolver::class,
        \Shopware\Core\Framework\App\AppUrlChangeResolver\UninstallAppsStrategy::class,
        \Shopware\Core\Framework\App\Cms\BlockTemplateLoader::class,
        \Shopware\Core\Framework\App\Command\ActivateAppCommand::class,
        \Shopware\Core\Framework\App\Command\AppPrinter::class,
        \Shopware\Core\Framework\App\Command\DeactivateAppCommand::class,
        \Shopware\Core\Framework\App\Command\InstallAppCommand::class,
        \Shopware\Core\Framework\App\Command\RefreshAppCommand::class,
        \Shopware\Core\Framework\App\Command\ResolveAppUrlChangeCommand::class,
        \Shopware\Core\Framework\App\Command\UninstallAppCommand::class,
        \Shopware\Core\Framework\App\Command\ValidateAppCommand::class,
        \Shopware\Core\Framework\App\Delta\AppConfirmationDeltaProvider::class,
        \Shopware\Core\Framework\App\Delta\DomainsDeltaProvider::class,
        \Shopware\Core\Framework\App\Delta\PermissionsDeltaProvider::class,
        \Shopware\Core\Framework\App\FlowAction\AppFlowActionLoadedSubscriber::class,
        \Shopware\Core\Framework\App\FlowAction\AppFlowActionProvider::class,
        \Shopware\Core\Framework\App\Hmac\QuerySigner::class,
        \Shopware\Core\Framework\App\Lifecycle\AppLifecycle::class,
        \Shopware\Core\Framework\App\Lifecycle\AppLifecycleIterator::class,
        \Shopware\Core\Framework\App\Lifecycle\AppLoader::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\ActionButtonPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\CmsBlockPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\CustomFieldPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\FlowActionPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\PaymentMethodPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\PermissionPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\RuleConditionPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\ScriptPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\TemplatePersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Persister\WebhookPersister::class,
        \Shopware\Core\Framework\App\Lifecycle\Registration\AppRegistrationService::class,
        \Shopware\Core\Framework\App\Lifecycle\Registration\HandshakeFactory::class,
        \Shopware\Core\Framework\App\Lifecycle\ScriptFileReader::class,
        \Shopware\Core\Framework\App\Lifecycle\Update\AbstractAppUpdater::class,
        \Shopware\Core\Framework\App\Manifest\ModuleLoader::class,
        \Shopware\Core\Framework\App\Payment\Handler\AppAsyncPaymentHandler::class,
        \Shopware\Core\Framework\App\Payment\Handler\AppPaymentHandler::class,
        \Shopware\Core\Framework\App\Payment\Handler\AppSyncPaymentHandler::class,
        \Shopware\Core\Framework\App\Payment\Payload\PayloadService::class,
        \Shopware\Core\Framework\App\Payment\PaymentMethodStateService::class,
        \Shopware\Core\Framework\App\ScheduledTask\DeleteCascadeAppsHandler::class,
        \Shopware\Core\Framework\App\ScheduledTask\DeleteCascadeAppsTask::class,
        \Shopware\Core\Framework\App\ScheduledTask\UpdateAppsHandler::class,
        \Shopware\Core\Framework\App\ScheduledTask\UpdateAppsTask::class,
        \Shopware\Core\Framework\App\ShopId\ShopIdProvider::class,
        \Shopware\Core\Framework\App\Subscriber\AppLoadedSubscriber::class,
        \Shopware\Core\Framework\App\Subscriber\AppScriptConditionConstraintsSubscriber::class,
        \Shopware\Core\Framework\App\Subscriber\CustomFieldProtectionSubscriber::class,
        \Shopware\Core\Framework\App\Template\TemplateLoader::class,
        \Shopware\Core\Framework\App\Template\TemplateStateService::class,
        \Shopware\Core\Framework\App\Validation\AppNameValidator::class,
        \Shopware\Core\Framework\App\Validation\ConfigValidator::class,
        \Shopware\Core\Framework\App\Validation\HookableValidator::class,
        \Shopware\Core\Framework\App\Validation\ManifestValidator::class,
        \Shopware\Core\Framework\App\Validation\TranslationValidator::class,
        \Shopware\Core\Framework\Changelog\ChangelogParser::class,
        \Shopware\Core\Framework\Changelog\Command\ChangelogChangeCommand::class,
        \Shopware\Core\Framework\Changelog\Command\ChangelogCheckCommand::class,
        \Shopware\Core\Framework\Changelog\Command\ChangelogCreateCommand::class,
        \Shopware\Core\Framework\Changelog\Command\ChangelogReleaseCommand::class,
        \Shopware\Core\Framework\Changelog\Processor\ChangelogGenerator::class,
        \Shopware\Core\Framework\Changelog\Processor\ChangelogReleaseCreator::class,
        \Shopware\Core\Framework\Changelog\Processor\ChangelogReleaseExporter::class,
        \Shopware\Core\Framework\Changelog\Processor\ChangelogValidator::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Command\CreateEntitiesCommand::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Command\CreateHydratorCommand::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Command\CreateSchemaCommand::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Command\DataAbstractionLayerValidateCommand::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Command\RefreshIndexCommand::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Facade\RepositoryFacadeHookFactory::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Facade\RepositoryWriterFacadeHookFactory::class,
        \Shopware\Core\Framework\DataAbstractionLayer\Indexing\Subscriber\RegisteredIndexerSubscriber::class,
        \Shopware\Core\Framework\Demodata\Command\DemodataCommand::class,
        \Shopware\Core\Framework\Demodata\Generator\CategoryGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\CustomerGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\FlowGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\MailHeaderFooterGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\MailTemplateGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\MediaGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\OrderGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\ProductGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\ProductManufacturerGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\ProductReviewGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\ProductStreamGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\PropertyGroupGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\RuleGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\TagGenerator::class,
        \Shopware\Core\Framework\Demodata\Generator\UserGenerator::class,
        \Shopware\Core\Framework\Demodata\PersonalData\CleanPersonalDataCommand::class,
        \Shopware\Core\Framework\Event\Command\DebugDumpBusinessEventsCommand::class,
        \Shopware\Core\Framework\Feature\Command\FeatureDumpCommand::class,
        \Shopware\Core\Framework\Log\ScheduledTask\LogCleanupTaskHandler::class,
        \Shopware\Core\Framework\MessageQueue\ScheduledTask\Command\RegisterScheduledTasksCommand::class,
        \Shopware\Core\Framework\MessageQueue\ScheduledTask\Command\ScheduledTaskRunner::class,
        \Shopware\Core\Framework\MessageQueue\ScheduledTask\Subscriber\UpdatePostFinishSubscriber::class,
        \Shopware\Core\Framework\Plugin\BundleConfigGenerator::class,
        \Shopware\Core\Framework\Plugin\Command\BundleDumpCommand::class,
        \Shopware\Core\Framework\Plugin\Command\Lifecycle\PluginActivateCommand::class,
        \Shopware\Core\Framework\Plugin\Command\Lifecycle\PluginDeactivateCommand::class,
        \Shopware\Core\Framework\Plugin\Command\Lifecycle\PluginInstallCommand::class,
        \Shopware\Core\Framework\Plugin\Command\Lifecycle\PluginUninstallCommand::class,
        \Shopware\Core\Framework\Plugin\Command\Lifecycle\PluginUpdateCommand::class,
        \Shopware\Core\Framework\Plugin\Command\PluginCreateCommand::class,
        \Shopware\Core\Framework\Plugin\Command\PluginListCommand::class,
        \Shopware\Core\Framework\Plugin\Command\PluginRefreshCommand::class,
        \Shopware\Core\Framework\Plugin\Command\PluginZipImportCommand::class,
        \Shopware\Core\Framework\Routing\CanonicalRedirectService::class,
        \Shopware\Core\Framework\Routing\SalesChannelRequestContextResolver::class,
        \Shopware\Core\Framework\Script\Api\ScriptApiRoute::class,
        \Shopware\Core\Framework\Script\Api\ScriptStoreApiRoute::class,
        \Shopware\Core\Framework\Script\Execution\ScriptExecutor::class,
        \Shopware\Core\Framework\Script\Execution\ScriptLoader::class,
        \Shopware\Core\Framework\Store\Api\ExtensionStoreActionsController::class,
        \Shopware\Core\Framework\Store\Api\ExtensionStoreDataController::class,
        \Shopware\Core\Framework\Store\Api\ExtensionStoreLicensesController::class,
        \Shopware\Core\Framework\Store\Api\FirstRunWizardController::class,
        \Shopware\Core\Framework\Store\Api\StoreController::class,
        \Shopware\Core\Framework\Store\Authentication\LocaleProvider::class,
        \Shopware\Core\Framework\Store\Authentication\StoreRequestOptionsProvider::class,
        \Shopware\Core\Framework\Store\Command\StoreDownloadCommand::class,
        \Shopware\Core\Framework\Store\Command\StoreLoginCommand::class,
        \Shopware\Core\Framework\Store\Services\AbstractExtensionDataProvider::class,
        \Shopware\Core\Framework\Store\Services\AbstractExtensionStoreLicensesService::class,
        \Shopware\Core\Framework\Store\Services\AbstractStoreAppLifecycleService::class,
        \Shopware\Core\Framework\Store\Services\ExtensionDownloader::class,
        \Shopware\Core\Framework\Store\Services\ExtensionLifecycleService::class,
        \Shopware\Core\Framework\Store\Services\ExtensionLoader::class,
        \Shopware\Core\Framework\Store\Services\FirstRunWizardClient::class,
        \Shopware\Core\Framework\Store\Services\StoreClient::class,
        \Shopware\Core\Framework\Store\Services\StoreService::class,
        \Shopware\Core\Framework\Update\Api\UpdateController::class,
        \Shopware\Core\Framework\Update\Services\CreateCustomAppsDir::class,
        \Shopware\Core\Framework\Update\Services\UpdateHtaccess::class,
        \Shopware\Core\Framework\Webhook\Handler\WebhookEventMessageHandler::class,
        \Shopware\Core\Framework\Webhook\WebhookCacheClearer::class,
        \Shopware\Core\Framework\Webhook\WebhookDispatcher::class,
        \Shopware\Core\Maintenance\SalesChannel\Command\SalesChannelCreateCommand::class,
        \Shopware\Core\Maintenance\SalesChannel\Command\SalesChannelListCommand::class,
        \Shopware\Core\Maintenance\SalesChannel\Command\SalesChannelMaintenanceDisableCommand::class,
        \Shopware\Core\Maintenance\SalesChannel\Command\SalesChannelMaintenanceEnableCommand::class,
        \Shopware\Core\Maintenance\SalesChannel\Command\SalesChannelUpdateDomainCommand::class,
        \Shopware\Core\Maintenance\SalesChannel\Service\SalesChannelCreator::class,
        \Shopware\Core\Maintenance\System\Command\SystemConfigureShopCommand::class,
        \Shopware\Core\Maintenance\User\Command\UserChangePasswordCommand::class,
        \Shopware\Core\Maintenance\User\Command\UserCreateCommand::class,
        \Shopware\Core\System\Language\SalesChannel\CachedLanguageRoute::class,
        \Shopware\Core\System\Language\SalesChannel\LanguageRoute::class,
        \Shopware\Core\System\Snippet\Api\SnippetController::class,
        \Shopware\Core\System\Snippet\Files\SnippetFileCollection::class,
        \Shopware\Core\System\Snippet\Files\SnippetFileCollectionFactory::class,
        \Shopware\Core\System\Snippet\Files\SnippetFileLoader::class,
        \Shopware\Core\System\Snippet\SnippetService::class,
    ];

    public function process(ContainerBuilder $container): void
    {
        $container->findDefinition('twig')->setMethodCalls();
        $container->removeAlias('translator');
        $this->removeObsoleteDefinitions($container);
        $this->removeObsoleteMessageHandlers($container);
    }

    private function removeObsoleteMessageHandlers(ContainerBuilder $container): void
    {
        $definition = $container->findDefinition('messenger.bus.shopware.messenger.handlers_locator');
        $handlers = [];

        foreach ($definition->getArgument(0) as $key => $value) {
            if (\str_starts_with($key, 'Shopware\\Core\\')) {
                continue;
            }

            $handlers[$key] = $value;
        }

        $definition->setArgument(0, $handlers);
    }

    private function removeObsoleteDefinitions(ContainerBuilder $container): void
    {
        foreach (self::REMOVE_DEFINITIONS as $serviceId) {
            $container->removeDefinition($serviceId);
        }
    }
}
